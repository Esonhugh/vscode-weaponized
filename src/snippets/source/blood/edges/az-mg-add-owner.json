{
    "AZMGAddOwner": {
        "meaning": "This edge is created during post-processing. It is created against all App Registrations and Service Principals when a Service Principal has Application.ReadWrite.All, against all Azure Service Principals with ServicePrincipalEndpoint.ReadWrite.All, against security groups with Directory.ReadWrite.All or Group.ReadWrite.All, and against all objects with RoleManagement.ReadWrite.Directory.",
        "common": "",
        "windows": {
            "BARK_Service_Principal": [
                {
                    "order": 1,
                    "command": "$MGToken = Get-MSGraphTokenWithClientCredentials -ClientID \"34c7f844-b6d7-47f3-b1b8-720e0ecba49c\" -ClientSecret \"asdf...\" -TenantName \"contoso.onmicrosoft.com\"",
                    "description": "Acquire MS Graph-scoped JWT using Service Principal credentials via BARK"
                },
                {
                    "order": 2,
                    "command": "New-ServicePrincipalOwner -ServicePrincipalObjectId \"082cf9b3-24e2-427b-bcde-88ffdccb5fad\" -NewOwnerObjectId \"cea271c4-7b01-4f57-932d-99d752bbbc60\" -Token $MGToken.access_token",
                    "description": "Add new owner to Service Principal using BARK"
                }
            ],
            "BARK_App_Registration": [
                {
                    "order": 1,
                    "command": "$MGToken = Get-MSGraphTokenWithClientCredentials -ClientID \"34c7f844-b6d7-47f3-b1b8-720e0ecba49c\" -ClientSecret \"asdf...\" -TenantName \"contoso.onmicrosoft.com\"",
                    "description": "Acquire MS Graph-scoped JWT using Service Principal credentials via BARK"
                },
                {
                    "order": 2,
                    "command": "New-AppOwner -AppObjectId \"52114a0d-fa5b-4ee5-9a29-2ba048d46eee\" -NewOwnerObjectId \"cea271c4-7b01-4f57-932d-99d752bbbc60\" -Token $MGToken.access_token",
                    "description": "Add new owner to App Registration using BARK"
                }
            ],
            "BARK_Group": [
                {
                    "order": 1,
                    "command": "$MGToken = Get-MSGraphTokenWithClientCredentials -ClientID \"34c7f844-b6d7-47f3-b1b8-720e0ecba49c\" -ClientSecret \"asdf...\" -TenantName \"contoso.onmicrosoft.com\"",
                    "description": "Acquire MS Graph-scoped JWT using Service Principal credentials via BARK"
                },
                {
                    "order": 2,
                    "command": "New-GroupOwner -GroupObjectId \"352032bf-161d-4788-b77c-b6f935339770\" -NewOwnerObjectId \"cea271c4-7b01-4f57-932d-99d752bbbc60\" -Token $MGToken.access_token",
                    "description": "Add new owner to Group using BARK"
                }
            ]
        },
        "linux": {
            "Graph_API_Service_Principal": [
                {
                    "order": 1,
                    "command": "curl -X POST -H \"Content-Type: application/x-www-form-urlencoded\" -d \"client_id=CLIENT_ID&client_secret=CLIENT_SECRET&scope=https://graph.microsoft.com/.default&grant_type=client_credentials\" \"https://login.microsoftonline.com/TENANT_ID/oauth2/v2.0/token\"",
                    "description": "Acquire access token for Microsoft Graph API using client credentials"
                },
                {
                    "order": 2,
                    "command": "curl -X POST -H \"Authorization: Bearer $ACCESS_TOKEN\" -H \"Content-Type: application/json\" \"https://graph.microsoft.com/v1.0/servicePrincipals/SP_ID/owners/\\$ref\" -d '{\"@odata.id\": \"https://graph.microsoft.com/v1.0/directoryObjects/NEW_OWNER_ID\"}'",
                    "description": "Add owner to Service Principal using Microsoft Graph REST API"
                }
            ],
            "Graph_API_Application": [
                {
                    "order": 1,
                    "command": "curl -X POST -H \"Content-Type: application/x-www-form-urlencoded\" -d \"client_id=CLIENT_ID&client_secret=CLIENT_SECRET&scope=https://graph.microsoft.com/.default&grant_type=client_credentials\" \"https://login.microsoftonline.com/TENANT_ID/oauth2/v2.0/token\"",
                    "description": "Acquire access token for Microsoft Graph API using client credentials"
                },
                {
                    "order": 2,
                    "command": "curl -X POST -H \"Authorization: Bearer $ACCESS_TOKEN\" -H \"Content-Type: application/json\" \"https://graph.microsoft.com/v1.0/applications/APP_ID/owners/\\$ref\" -d '{\"@odata.id\": \"https://graph.microsoft.com/v1.0/directoryObjects/NEW_OWNER_ID\"}'",
                    "description": "Add owner to Application using Microsoft Graph REST API"
                }
            ],
            "Graph_API_Group": [
                {
                    "order": 1,
                    "command": "curl -X POST -H \"Content-Type: application/x-www-form-urlencoded\" -d \"client_id=CLIENT_ID&client_secret=CLIENT_SECRET&scope=https://graph.microsoft.com/.default&grant_type=client_credentials\" \"https://login.microsoftonline.com/TENANT_ID/oauth2/v2.0/token\"",
                    "description": "Acquire access token for Microsoft Graph API using client credentials"
                },
                {
                    "order": 2,
                    "command": "curl -X POST -H \"Authorization: Bearer $ACCESS_TOKEN\" -H \"Content-Type: application/json\" \"https://graph.microsoft.com/v1.0/groups/GROUP_ID/owners/\\$ref\" -d '{\"@odata.id\": \"https://graph.microsoft.com/v1.0/directoryObjects/NEW_OWNER_ID\"}'",
                    "description": "Add owner to Group using Microsoft Graph REST API"
                }
            ]
        }
    }
}
