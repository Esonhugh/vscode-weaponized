{
    "AZOwns": {
        "meaning": "The principal is granted owner rights on the target resource in Entra ID. AZOwns targets resources in Entra ID (such as AZGroup, AZServicePrincipal, and AZDevice) from object-specific ownership. Object ownership means almost all abuses are possible against the target object, providing comprehensive control over the owned resource.",
        "common": "",
        "windows": {
            "Azure_Portal_Management": [
                {
                    "order": 1,
                    "command": "# Navigate to Azure Portal -> Azure Active Directory -> Target Object Type",
                    "description": "Access Azure AD management interface for the owned object type"
                },
                {
                    "order": 2,
                    "command": "# Locate owned object and access its properties/settings",
                    "description": "Find and select the target object you have ownership of"
                },
                {
                    "order": 3,
                    "command": "# Modify object properties, permissions, or configuration as needed",
                    "description": "Exercise ownership rights to modify object settings and permissions"
                }
            ],
            "PowerShell_AzureAD": [
                {
                    "order": 1,
                    "command": "Connect-AzureAD -AccountId owner@domain.com",
                    "description": "Connect to Azure AD using account with ownership privileges"
                },
                {
                    "order": 2,
                    "command": "Get-AzureADGroup -ObjectId OWNED_GROUP_ID | Set-AzureADGroup -Description \"Modified by owner\"",
                    "description": "Modify owned group properties using ownership rights"
                },
                {
                    "order": 3,
                    "command": "Add-AzureADGroupMember -ObjectId OWNED_GROUP_ID -RefObjectId USER_ID",
                    "description": "Add members to owned group using administrative privileges"
                }
            ],
            "BARK_Ownership": [
                {
                    "order": 1,
                    "command": "$Token = Get-GraphTokenWithRefreshToken -RefreshToken \"0.ARwA6WgJJ9X2qk...\" -TenantID \"contoso.onmicrosoft.com\"",
                    "description": "Acquire MS Graph token for ownership operations using BARK"
                },
                {
                    "order": 2,
                    "command": "# Use appropriate BARK function based on owned object type (App, ServicePrincipal, Group, etc.)",
                    "description": "Execute ownership-based modifications using BARK toolkit"
                },
                {
                    "order": 3,
                    "command": "New-AppRegSecret -AppRegObjectID \"OWNED_APP_ID\" -Token $Token.access_token",
                    "description": "Add secrets to owned applications for persistence"
                }
            ]
        },
        "linux": {
            "Azure_CLI": [
                {
                    "order": 1,
                    "command": "az login --username owner@domain.com --password password",
                    "description": "Authenticate to Azure using account with ownership privileges"
                },
                {
                    "order": 2,
                    "command": "az ad group update --group OWNED_GROUP_ID --description \"Modified by owner\"",
                    "description": "Modify owned group properties using Azure CLI"
                },
                {
                    "order": 3,
                    "command": "az ad group member add --group OWNED_GROUP_ID --member-id USER_ID",
                    "description": "Add members to owned groups using ownership rights"
                }
            ],
            "Microsoft_Graph_API": [
                {
                    "order": 1,
                    "command": "curl -X PATCH 'https://graph.microsoft.com/v1.0/groups/{owned-group-id}' -H 'Authorization: Bearer $ACCESS_TOKEN' -H 'Content-Type: application/json' -d '{\"description\": \"Modified by owner\"}'",
                    "description": "Modify owned group properties using Graph API"
                },
                {
                    "order": 2,
                    "command": "curl -X POST 'https://graph.microsoft.com/v1.0/applications/{owned-app-id}/addPassword' -H 'Authorization: Bearer $ACCESS_TOKEN' -H 'Content-Type: application/json' -d '{\"passwordCredential\": {\"displayName\": \"OwnerSecret\"}}'",
                    "description": "Add secrets to owned applications using Graph API"
                },
                {
                    "order": 3,
                    "command": "curl -X POST 'https://graph.microsoft.com/v1.0/servicePrincipals/{owned-sp-id}/owners/$ref' -H 'Authorization: Bearer $ACCESS_TOKEN' -H 'Content-Type: application/json' -d '{\"@odata.id\": \"https://graph.microsoft.com/v1.0/users/{user-id}\"}'",
                    "description": "Add additional owners to owned service principals"
                }
            ],
            "ROADtools": [
                {
                    "order": 1,
                    "command": "roadrecon auth -u owner@domain.com -p password",
                    "description": "Authenticate to Azure AD using ROADtools with owner account"
                },
                {
                    "order": 2,
                    "command": "roadrecon gather",
                    "description": "Gather information about owned objects and available operations"
                },
                {
                    "order": 3,
                    "command": "# Use ROADtools to identify and abuse ownership relationships",
                    "description": "Leverage ROADtools for comprehensive ownership-based operations"
                }
            ]
        }
    }
}
