{
    "Contains": {
        "meaning": "GPOs linked to a container apply to all objects that are contained by the container. Additionally, ACEs set on a parent OU may inherit down to child objects. Permissions on the parent of a child object may enable compromise of the child object through inherited ACEs or linked GPOs.",
        "common": "",
        "windows": {
            "GPO_Inheritance_Abuse": [
                {
                    "order": 1,
                    "command": "Get-GPInheritance -Target \"OU=ChildOU,DC=domain,DC=com\"",
                    "description": "Check GPO inheritance for target child organizational unit"
                },
                {
                    "order": 2,
                    "command": "Get-GPOReport -All -ReportType HTML -Path GPOReport.html",
                    "description": "Generate comprehensive GPO report to identify inheritance chains"
                },
                {
                    "order": 3,
                    "command": "# Modify parent OU GPO to include malicious configuration affecting child objects",
                    "description": "Leverage parent OU GPO permissions to affect contained child objects"
                }
            ],
            "ACL_Inheritance_Analysis": [
                {
                    "order": 1,
                    "command": "Get-Acl \"AD:OU=ParentOU,DC=domain,DC=com\" | Select -ExpandProperty Access",
                    "description": "Examine ACL permissions on parent organizational unit"
                },
                {
                    "order": 2,
                    "command": "Get-ADObject \"OU=ChildOU,OU=ParentOU,DC=domain,DC=com\" -Properties nTSecurityDescriptor",
                    "description": "Check inherited permissions on child objects from parent"
                },
                {
                    "order": 3,
                    "command": "# Exploit inherited permissions to modify child objects",
                    "description": "Use inherited ACE permissions to compromise contained objects"
                }
            ],
            "Container_Permission_Check": [
                {
                    "order": 1,
                    "command": "dsacls \"OU=ParentOU,DC=domain,DC=com\"",
                    "description": "Display detailed ACL information for parent container"
                },
                {
                    "order": 2,
                    "command": "Get-ADOrganizationalUnit -Filter * -Properties CanonicalName,nTSecurityDescriptor",
                    "description": "Enumerate all OUs and their security descriptors for inheritance analysis"
                },
                {
                    "order": 3,
                    "command": "# Identify exploitable inheritance relationships",
                    "description": "Map container relationships for privilege escalation opportunities"
                }
            ]
        },
        "linux": {
            "LDAP_Container_Analysis": [
                {
                    "order": 1,
                    "command": "ldapsearch -x -D 'CN=user,CN=Users,DC=domain,DC=com' -w password -h dc.domain.com -b 'OU=ParentOU,DC=domain,DC=com' '(objectClass=organizationalUnit)' distinguishedName",
                    "description": "Query LDAP for organizational unit structure and containment relationships"
                },
                {
                    "order": 2,
                    "command": "ldapsearch -x -D 'CN=user,CN=Users,DC=domain,DC=com' -w password -h dc.domain.com -b 'OU=ParentOU,DC=domain,DC=com' nTSecurityDescriptor",
                    "description": "Retrieve security descriptors for parent containers"
                },
                {
                    "order": 3,
                    "command": "# Analyze inheritance patterns for exploitation opportunities",
                    "description": "Identify child objects affected by parent container permissions"
                }
            ],
            "BloodHound_Analysis": [
                {
                    "order": 1,
                    "command": "python3 bloodhound.py -u user@domain.com -p password -d domain.com -dc dc.domain.com -c All",
                    "description": "Collect Active Directory data including container relationships"
                },
                {
                    "order": 2,
                    "command": "# Use BloodHound GUI to analyze Contains relationships",
                    "description": "Visualize container hierarchy and inheritance paths in BloodHound"
                },
                {
                    "order": 3,
                    "command": "# Query: MATCH (n:OU)-[:Contains*]->(m) WHERE n.name = 'PARENT_OU' RETURN m",
                    "description": "Cypher query to find all objects contained by parent OU"
                }
            ],
            "Manual_GPO_Analysis": [
                {
                    "order": 1,
                    "command": "smbclient //dc.domain.com/SYSVOL -U 'domain/user%password' -c 'ls'",
                    "description": "Access SYSVOL share to examine GPO structure"
                },
                {
                    "order": 2,
                    "command": "rpcclient -U 'domain/user%password' dc.domain.com -c 'enumdomgroups'",
                    "description": "Enumerate domain groups to understand container membership"
                },
                {
                    "order": 3,
                    "command": "# Analyze GPO links and inheritance through SYSVOL examination",
                    "description": "Manual analysis of GPO inheritance affecting contained objects"
                }
            ]
        }
    }
}
